<!-- ç‰ˆæœ¬ï¼š2025-06-22 v03 -->

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç«¹å±±å¿µä½›æœƒ æ³•æœƒç´°æµ</title>

  <style>
    :root {
      /* ===== æ•´é«” ===== */
      --scale: 0.64;
      --table-width: 800px;

      /* é‚Šè·èˆ‡ç·šæ¢ */
      --cell-padding: 8px;
      --outer-border-width: 3px;
      --inner-border-width: 1px;
      --border-color: #ccc;

      /* è‰²å½© */
      --header-bg: #f0f0f0;
      --row-odd-bg: #ffffff;
      --row-even-bg: #fafafa;

      /* æ¬„å¯¬ */
      --time-col-width: 90px;
      --role-col-width: 130px;
      --content-col-width: 640px;

      /* å­—é«”å¤§å° */
      --title-font-size: 32px;
      --header-font-size: 22px;
      --time-font-size: 20px;
      --role-font-size: 20px;
      --content-font-size: 20px;

      /* æ¬„ä½åç§»é‡ */
      --time-offset-x: 9px;   --time-offset-y: 0px;
      --role-offset-x: 0px;   --role-offset-y: 0px;
      --content-offset-x: 0px;--content-offset-y: 0px;
    }

    /* ===== åŸºç¤æ¨£å¼ ===== */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Microsoft JhengHei","Noto Sans TC",sans-serif;
      background: #f9f9f9; color: #333;
      padding: 16px;
      display: flex; flex-direction: column; align-items: center;
    }
    #toggleBtn {
      margin-bottom: 16px; padding: 6px 12px;
      border: 1px solid #333; background: #fff;
      cursor: pointer;
    }

    /* ===== æ§åˆ¶é¢æ¿ ===== */
    .controls {
      width: 90%; max-width: 760px;
      overflow: hidden;
      transition: max-height .3s ease, padding .3s ease, margin .3s ease;
      max-height: 0; padding: 0; margin-bottom: 0; border: none;
    }
    .controls.expanded {
      border: 1px solid #333;
      padding: 16px; margin-bottom: 32px;
      max-height: 2200px;
    }
    .controls h4 {
      text-align: center; margin-bottom: 12px; font-size: 1.05em;
    }
    .control-group {
      display: flex; align-items: center; margin: 6px 0; flex-wrap: wrap;
    }
    .control-group label  { flex: 1 1 200px; font-size: .9em; }
    .control-group input[type=range] { flex: 2 1 220px; margin: 0 8px; }
    .control-group .value { width: 56px; text-align: right; }

    /* ===== è¡¨æ ¼å€ ===== */
    #wrapper { transform-origin: top center; transform: scale(var(--scale)); }

    .table-container {
      width: var(--table-width);
      background: #fff; border-radius: 4px;
      overflow: hidden;
      border: var(--outer-border-width) solid var(--border-color);
      box-shadow: 0 2px 6px rgba(0,0,0,.1);
    }
    .table-container h3 {
      margin: 0; padding: 12px;
      font-size: var(--title-font-size);
      text-align: center;
      border-bottom: var(--inner-border-width) solid var(--border-color);
    }

    table { width: 100%; border-collapse: collapse; }
    th, td {
      border: var(--inner-border-width) solid var(--border-color);
      padding: var(--cell-padding);
      text-align: left;
    }
    th { background: var(--header-bg); font-size: var(--header-font-size); }
    tr:nth-child(odd)  td { background: var(--row-odd-bg); }
    tr:nth-child(even) td { background: var(--row-even-bg); }

    td.time {
      width: var(--time-col-width);
      font-size: var(--time-font-size);
      font-weight: bold;
      transform: translate(var(--time-offset-x), var(--time-offset-y));
      white-space: nowrap;
    }
    td.role {
      width: var(--role-col-width);
      font-size: var(--role-font-size);
      transform: translate(var(--role-offset-x), var(--role-offset-y));
    }
    td.content {
      width: var(--content-col-width);
      font-size: var(--content-font-size);
      transform: translate(var(--content-offset-x), var(--content-offset-y));
    }

    @media (max-width: 600px) {
      .table-container { width: 100%; box-shadow: none; }
      .table-container h3 { font-size: calc(var(--title-font-size) * .9); }
      th, td { padding: calc(var(--cell-padding) * .8); }
    }
  </style>
</head>
<body>

  <!-- ===== é¢æ¿é–‹é—œ ===== -->
  <button id="toggleBtn">é¡¯ç¤ºæ§åˆ¶é¢æ¿ â–¼</button>

  <!-- ===== æ§åˆ¶é¢æ¿ ===== -->
  <div class="controls" id="controls">
    <h4>ğŸ› ï¸ è¡¨æ ¼ç‰ˆé¢å¯èª¿åƒæ•¸</h4>

    <!-- æ•´é«” -->
    <div class="control-group">
      <label for="scaleSlider">æ•´é«”ç¸®æ”¾</label>
      <input id="scaleSlider" type="range" min="50" max="200" value="100">
      <div class="value"><span id="scaleVal">64</span>%</div>
    </div>
    <div class="control-group">
      <label for="tableWidthSlider">æ•´é«”è¡¨æ ¼å¯¬</label>
      <input id="tableWidthSlider" type="range" min="300" max="1200" value="800">
      <div class="value"><span id="tableWidthVal">800</span>px</div>
    </div>
    <div class="control-group">
      <label for="outerBorderSlider">è¡¨æ ¼å¤–æ¡†ç²—ç´°</label>
      <input id="outerBorderSlider" type="range" min="0" max="10" value="3">
      <div class="value"><span id="outerBorderVal">3</span>px</div>
    </div>
    <div class="control-group">
      <label for="innerBorderSlider">è¡¨æ ¼å…§ç·šç²—ç´°</label>
      <input id="innerBorderSlider" type="range" min="0" max="10" value="1">
      <div class="value"><span id="innerBorderVal">1</span>px</div>
    </div>

    <!-- æ¬„å¯¬ -->
    <div class="control-group">
      <label for="timeWidthSlider">æ™‚é–“æ¬„å¯¬</label>
      <input id="timeWidthSlider" type="range" min="80" max="300" value="90">
      <div class="value"><span id="timeWidthVal">90</span>px</div>
    </div>
    <div class="control-group">
      <label for="roleWidthSlider">è·ç¨±æ¬„å¯¬</label>
      <input id="roleWidthSlider" type="range" min="100" max="400" value="130">
      <div class="value"><span id="roleWidthVal">130</span>px</div>
    </div>
    <div class="control-group">
      <label for="contentWidthSlider">å…§å®¹æ¬„å¯¬</label>
      <input id="contentWidthSlider" type="range" min="200" max="800" value="640">
      <div class="value"><span id="contentWidthVal">640</span>px</div>
    </div>

    <!-- å­—é«”å¤§å° -->
    <div class="control-group">
      <label for="titleSlider">ä¸»æ¨™é¡Œå­—é«”</label>
      <input id="titleSlider" type="range" min="14" max="100" value="32">
      <div class="value"><span id="titleVal">32</span>px</div>
    </div>
    <div class="control-group">
      <label for="headerFontSlider">è¡¨é ­å­—é«”</label>
      <input id="headerFontSlider" type="range" min="12" max="30" value="22">
      <div class="value"><span id="headerFontVal">22</span>px</div>
    </div>
    <div class="control-group">
      <label for="timeFontSlider">æ™‚é–“æ¬„å­—é«”</label>
      <input id="timeFontSlider" type="range" min="12" max="30" value="20">
      <div class="value"><span id="timeFontVal">20</span>px</div>
    </div>
    <div class="control-group">
      <label for="roleFontSlider">è·ç¨±æ¬„å­—é«”</label>
      <input id="roleFontSlider" type="range" min="12" max="30" value="20">
      <div class="value"><span id="roleFontVal">20</span>px</div>
    </div>
    <div class="control-group">
      <label for="contentFontSlider">å…§å®¹æ¬„å­—é«”</label>
      <input id="contentFontSlider" type="range" min="12" max="30" value="20">
      <div class="value"><span id="contentFontVal">20</span>px</div>
    </div>

    <!-- åç§»é‡ï¼šæ™‚é–“ -->
    <div class="control-group">
      <label for="timeOffsetXSlider">æ™‚é–“æ¬„ X åç§»</label>
      <input id="timeOffsetXSlider" type="range" min="-50" max="50" value="0">
      <div class="value"><span id="timeOffsetXVal">9</span>px</div>
    </div>
    <div class="control-group">
      <label for="timeOffsetYSlider">æ™‚é–“æ¬„ Y åç§»</label>
      <input id="timeOffsetYSlider" type="range" min="-50" max="50" value="0">
      <div class="value"><span id="timeOffsetYVal">0</span>px</div>
    </div>

    <!-- åç§»é‡ï¼šè·ç¨± -->
    <div class="control-group">
      <label for="roleOffsetXSlider">è·ç¨±æ¬„ X åç§»</label>
      <input id="roleOffsetXSlider" type="range" min="-50" max="50" value="0">
      <div class="value"><span id="roleOffsetXVal">0</span>px</div>
    </div>
    <div class="control-group">
      <label for="roleOffsetYSlider">è·ç¨±æ¬„ Y åç§»</label>
      <input id="roleOffsetYSlider" type="range" min="-50" max="50" value="0">
      <div class="value"><span id="roleOffsetYVal">0</span>px</div>
    </div>

    <!-- åç§»é‡ï¼šå…§å®¹ -->
    <div class="control-group">
      <label for="contentOffsetXSlider">å…§å®¹æ¬„ X åç§»</label>
      <input id="contentOffsetXSlider" type="range" min="-50" max="50" value="0">
      <div class="value"><span id="contentOffsetXVal">0</span>px</div>
    </div>
    <div class="control-group">
      <label for="contentOffsetYSlider">å…§å®¹æ¬„ Y åç§»</label>
      <input id="contentOffsetYSlider" type="range" min="-50" max="50" value="0">
      <div class="value"><span id="contentOffsetYVal">0</span>px</div>
    </div>

    <!-- å°å‡ºæŒ‰éˆ• -->
    <div class="control-group" style="justify-content:center;margin-top:14px;">
      <button id="exportBtn" style="padding:6px 20px;cursor:pointer;">å°å‡ºåƒæ•¸</button>
    </div>
  </div>

  <!-- ===== è¡¨æ ¼ ===== -->
  <div id="wrapper">
    <div class="table-container">
      <h3>é€±å››å…±ä¿®æ³•æœƒç´°æµ</h3>
      <table>
        <thead>
          <tr>
            <th class="time">æ™‚é–“</th>
            <th class="role">è·ç¨±</th>
            <th class="content">å…§å®¹</th>
          </tr>
        </thead>
        <tbody id="scheduleBody"></tbody>
      </table>
    </div>
  </div>

  <script>
    /* ========== é¢æ¿æ”¶åˆ ========= */
    const btn = document.getElementById('toggleBtn');
    const ctrl = document.getElementById('controls');
    btn.onclick = () => {
      const open = ctrl.classList.toggle('expanded');
      btn.textContent = open ? 'éš±è—æ§åˆ¶é¢æ¿ â–²' : 'é¡¯ç¤ºæ§åˆ¶é¢æ¿ â–¼';
    };

    /* ========== ç¶å®šæ»‘æ¡¿åˆ° CSS è®Šæ•¸ ========= */
    function bind(id, variable, suffix = '') {
      const slider = document.getElementById(id);
      const value  = document.getElementById(id.replace('Slider', 'Val'));
      const update = () => {
        const v = slider.value;
        const cssVal = variable === '--scale' ? v / 100 : v + suffix;
        document.documentElement.style.setProperty(variable, cssVal);
        value.textContent = v;
      };
      slider.addEventListener('input', update);
      update(); // åˆå§‹
    }

    /* æ•´é«”ã€ç·šæ¢ */
    bind('scaleSlider',        '--scale');
    bind('tableWidthSlider',   '--table-width',        'px');
    bind('outerBorderSlider',  '--outer-border-width', 'px');
    bind('innerBorderSlider',  '--inner-border-width', 'px');

    /* æ¬„å¯¬ */
    bind('timeWidthSlider',    '--time-col-width',     'px');
    bind('roleWidthSlider',    '--role-col-width',     'px');
    bind('contentWidthSlider', '--content-col-width',  'px');

    /* å­—é«” */
    bind('titleSlider',        '--title-font-size',    'px');
    bind('headerFontSlider',   '--header-font-size',   'px');
    bind('timeFontSlider',     '--time-font-size',     'px');
    bind('roleFontSlider',     '--role-font-size',     'px');
    bind('contentFontSlider',  '--content-font-size',  'px');

    /* åç§»é‡ */
    bind('timeOffsetXSlider',     '--time-offset-x',    'px');
    bind('timeOffsetYSlider',     '--time-offset-y',    'px');
    bind('roleOffsetXSlider',     '--role-offset-x',    'px');
    bind('roleOffsetYSlider',     '--role-offset-y',    'px');
    bind('contentOffsetXSlider',  '--content-offset-x', 'px');
    bind('contentOffsetYSlider',  '--content-offset-y', 'px');

    /* ========== ç”¢ç”Ÿè¡¨æ ¼ ========= */
    fetch('schedule-4.json')
      .then(r => r.json())
      .then(data => {
        const tbody = document.getElementById('scheduleBody');
        data.forEach(group => {
          group.items.forEach((it, idx) => {
            const tr = document.createElement('tr');

            /* æ™‚é–“æ¬„åªå‡ºç¾ä¸€æ¬¡ä¸¦ rowspan */
            if (idx === 0) {
              const tdTime = document.createElement('td');
              tdTime.className = 'time';
              tdTime.rowSpan   = group.items.length;
              tdTime.textContent = group.time;
              tr.appendChild(tdTime);
            }

            const tdRole = document.createElement('td');
            tdRole.className = 'role';
            tdRole.textContent = it.role;
            tr.appendChild(tdRole);

            const tdContent = document.createElement('td');
            tdContent.className = 'content';
            tdContent.textContent = it.content;
            tr.appendChild(tdContent);

            tbody.appendChild(tr);
          });
        });
      })
      .catch(err => console.error('è®€å– schedule-4.json å¤±æ•—ï¼š', err));

    /* ========== å°å‡ºåƒæ•¸ ========= */
    document.getElementById('exportBtn').onclick = () => {
      /* æ‰€æœ‰è®Šæ•¸åç¨± */
      const vars = [
        '--scale','--table-width','--outer-border-width','--inner-border-width',
        '--time-col-width','--role-col-width','--content-col-width',
        '--title-font-size','--header-font-size','--time-font-size',
        '--role-font-size','--content-font-size',
        '--time-offset-x','--time-offset-y',
        '--role-offset-x','--role-offset-y',
        '--content-offset-x','--content-offset-y'
      ];

      const styles = getComputedStyle(document.documentElement);
      const obj = {};
      vars.forEach(v => { obj[v] = styles.getPropertyValue(v).trim(); });

      const json = JSON.stringify(obj, null, 2);

      /* è¤‡è£½åˆ°å‰ªè²¼ç°¿ */
      navigator.clipboard.writeText(json).then(
        () => alert('åƒæ•¸å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼'),
        () => alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½')
      );

      /* ä¸‹è¼‰æª”æ¡ˆ */
      const blob = new Blob([json], {type: 'application/json'});
      const url  = URL.createObjectURL(blob);
      const a    = document.createElement('a');
      a.href = url;
      a.download = 'schedule-settings.json';
      a.click();
      URL.revokeObjectURL(url);
    };
  </script>
</body>
</html>
